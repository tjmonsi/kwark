let t=0;const e={},r=/([A-Z])/g;function s(t){return e[t]||(e[t]=t.replace(r,"-$1").toLowerCase())}const i=t=>-1===t.indexOf(".")?t:t.slice(0,t.indexOf(".")),a=Promise.resolve(!0),o=1,n=4,p=8,h=16,c=32,u={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},d=(t,e)=>e!==t&&(e==e||t==t),_={attribute:!0,type:String,converter:u,reflect:!1,hasChanged:d},l=(e=>{let r=e.__mixinApplications;r||(r=new WeakMap,e.__mixinApplications=r);let s=t++;return function(t){let i=t.__mixinSet;if(i&&i[s])return t;let a=r,o=a.get(t);o||(o=e(t),a.set(t,o));let n=Object.create(o.__mixinSet||i||null);return n[s]=!0,o.__mixinSet=n,o}})(t=>{return class extends t{static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach((e,r)=>{const s=this._attributeNameForProperty(r,e);void 0!==s&&(this._attributeToPropertyMap.set(s,r),t.push(s))}),t}static finalize(){if(this.hasOwnProperty("finalized")&&this.finalized)return null;const t=Object.getPrototypeOf(this);if("function"==typeof t.finalize&&t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const r of e)this.createProperty(r,t[r])}}static _ensureClassProperties(){if(!this.hasOwnProperty("_classProperties")){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach((t,e)=>this._classProperties.set(e,t))}}static createProperty(t,e){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const r="symbol"==typeof t?Symbol(t):`__${t}`;Object.defineProperty(this.prototype,t,{get(){return this[r]},set(e){const s=this[t];this[r]=e,this._requestUpdate(t,s)},configurable:!0,enumerable:!0})}static _attributeNameForProperty(t,{attribute:e}){return!1===e?void 0:"string"==typeof e?e:"string"==typeof t?s(t):void 0}static _valueHasChanged(t,e,r=d){return r(t,e)}static _propertyValueFromAttribute(t,e){const r=e.type,s=e.converter||u,i="function"==typeof s?s:s.fromAttribute;return i?i(t,r):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const r=e.type,s=e.converter;return(s&&s.toAttribute||u.toAttribute)(t,r)}constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=a,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}})}_applyInstanceProperties(){this._instanceProperties.forEach((t,e)=>{this[e]=t}),this._instanceProperties=void 0}connectedCallback(){this._updateState=this._updateState|c,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}_propertyNotify(t,e){this.dispatchEvent(new window.CustomEvent(`${s(i(t))}-change`,{detail:e}))}attributeChangedCallback(t,e,r){e!==r&&this._attributeToProperty(t,r)}_propertyToAttribute(t,e,r=_){const s=this.constructor,i=s._attributeNameForProperty(t,r);if(void 0!==i){const t=s._propertyValueToAttribute(e,r);if(void 0===t)return;this._updateState=this._updateState|p,null==t?this.removeAttribute(i):this.setAttribute(i,t),this._updateState=this._updateState&~p}}_attributeToProperty(t,e){if(this._updateState&p)return;const r=this.constructor,s=r._attributeToPropertyMap.get(t);if(void 0!==s){const t=r._classProperties.get(s)||_;this._updateState=this._updateState|h,this[s]=r._propertyValueFromAttribute(e,t),this._updateState=this._updateState&~h}}_requestUpdate(t,e){let r=!0;if(void 0!==t){const s=this.constructor,i=s._classProperties.get(t)||_;s._valueHasChanged(this[t],e,i.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==i.reflect||this._updateState&h||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,i))):r=!1}!this._hasRequestedUpdate&&r&&this._enqueueUpdate()}requestUpdate(t,e){return this._requestUpdate(t,e),this.updateComplete}async _enqueueUpdate(){let t,e;this._updateState=this._updateState|n;const r=this._updatePromise;this._updatePromise=new Promise((r,s)=>{t=r,e=s});try{await r}catch(t){}this._hasConnected||await new Promise(t=>{this._hasConnectedResolver=t});try{const t=this.performUpdate();null!=t&&await t}catch(t){e(t)}t(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&c}get _hasRequestedUpdate(){return this._updateState&n}get hasUpdated(){return this._updateState&o}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{(t=this.shouldUpdate(e))&&this.update(e)}catch(e){throw t=!1,e}finally{this._markUpdated()}t&&(this._updateState&o||(this._updateState=this._updateState|o,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~n}get updateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((t,e)=>this._propertyToAttribute(e,this[e],t)),this._reflectingProperties=void 0)}updated(t){}firstUpdated(t){}}});export{l as PropertiesMixin,u as defaultConverter,d as notEqual};
